server:
  port: 8080
  servlet:
    context-path: /hopechain

spring:
  application:
    name: bds-gateway-service  # 服务名称
  config:
    import:
      - nacos:common.yaml
      - nacos:redis-config.yaml
  cloud:
    nacos:
      discovery:
        server-addr: 113.45.133.84:8848
        username: ${NACOS_USERNAME}
        password: ${NACOS_PASSWORD}
      config:
        file-extension: yaml
        refresh-enabled: false
        shared-configs:
          - data-id: common.yaml
          - data-id: redis-config.yaml
    gateway:
      discovery:
        locator:
          enabled: true # 开启动态路由
      routes:
        - id: user
          uri: lb://bds-user-service
          predicates:
            - Path=/hopechain/user/**
          filters:
            - StripPrefix=1
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 5
                redis-rate-limiter.burstCapacity: 10
                key-resolver: "#{@remoteAddrKeyResolver}"
            - name: CircuitBreaker
              args:
                name: userCircuitBreaker
                fallbackUri: forward:/fallback/user
  # 缓存配置
  cache:
    type: caffeine
    caffeine:
      spec: maximumSize=1000,expireAfterWrite=60s
